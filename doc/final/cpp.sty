\ProvidesPackage{cpp}

\input{requires.tex}
\input{colors.tex}
\input{captions.tex}
\input{lengths.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Captions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareCaptionFormat{cpplisting}{\colorbox[HTML]{dab359}{\parbox{\dimexpr\textwidth-2\fboxsep\relax}{#1#2#3}}}
\captionsetup[CPP]{format=cpplisting,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,small}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Typesetting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language Definition
\lstdefinelanguage{cpp}{%
  % Basic settings
  basicstyle=\smaller\ttfamily,
  tabsize=4,
  %frame=single,
  showstringspaces=false,
  mathescape=true,
  breaklines=true,
  numbers=left,
  % Keywords, strings, and comments
  keywords={%
    alignas, alignof, and, and_eq, asm, auto, bitand, bitor, bool, break, case,
    catch, char, char16_t, char32_t, class, compl, const, constexpr,
    const_cast, continue, decltype, default, delete, do, double, dynamic_cast,
    else, enum, explicit, export, extern, false, float, for, friend, goto, if,
    inline, int, long, mutable, namespace, new, noexcept, not, not_eq, nullptr,
    operator, or, or_eq, private, protected, public, register,
    reinterpret_cast, return, short, signed, sizeof, static, static_assert,
    static_cast, struct, switch, template, this, thread_local, throw, true,
    try, typedef, typeid, typename, union, unsigned, using, virtual, void,
    volatile, wchar_t, while, xor, xor_eq
  },
  keywords=[2]{%
    vector, std
  },
  morestring=[b]",
  morestring=[b]',
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morecomment=[l][\color{gray}]{\#},
  % Colors and style
  %backgroundcolor=\color{BackgroundYellow},
  keywordstyle=\color{blue},
  keywordstyle=[2]\color{DarkOrchid},
  commentstyle=\color{ForestGreen},
  stringstyle=\color{Red},
  numberstyle=\color{SolarizedGrey}
}

% environment
\lstnewenvironment{CPP}[1][]{%
  \lstset{language=cpp, linewidth=80\charwidth, #1}
  \captionsetup{options=CPP}
}{}


% inline definition.
\newcommand*{\cpp}{\lstinline[{language=cpp}]}

% input listing definition
\newcommand{\inputcpp}[2][ ]{%
  {%
  \captionsetup{options=CPP}
  \lstset{linewidth=80\charwidth}
  \lstinputlisting[language=cpp,#1]{#2} 
  }
}
