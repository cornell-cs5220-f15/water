Bottleneck code in \verb|compute_step|^^E^^L 
